<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Jadwal Show - JKT48 Theater</title>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:Arial,sans-serif;background:#f5f5f5;color:#333;min-height:100vh;transition:background 0.3s,color 0.3s}
body.dark{background:#0a0e1a;color:#e5e7eb}
header{background:#e60012;text-align:center;padding:20px 60px 20px 20px;font-size:24px;font-weight:bold;color:#fff;position:relative;display:flex;align-items:center;justify-content:center}
.back-btn{position:absolute;left:20px;top:50%;transform:translateY(-50%);background:rgba(255,255,255,0.2);border:none;color:#fff;width:40px;height:40px;border-radius:50%;cursor:pointer;display:flex;align-items:center;justify-content:center}
.back-btn:hover{background:rgba(255,255,255,0.3)}
.theme-toggle{position:absolute;right:20px;top:50%;transform:translateY(-50%);background:rgba(255,255,255,0.2);border:none;color:#fff;width:40px;height:40px;border-radius:50%;cursor:pointer;display:flex;align-items:center;justify-content:center;padding:8px}
.theme-toggle:hover{background:rgba(255,255,255,0.3)}
.theme-toggle svg{width:20px;height:20px}
body.dark .back-btn,body.dark .theme-toggle{background:rgba(0,0,0,0.2)}
.container{max-width:1200px;margin:0 auto;padding:20px}
.date-filter{background:#fff;border-radius:12px;padding:20px;margin-bottom:20px;border:1px solid #e5e7eb}
body.dark .date-filter{background:#1b1f3a;border-color:#2d3548}
.date-filter h3{font-size:16px;margin-bottom:16px;color:#e60012}
body.dark .date-filter h3{color:#f87171}
.date-buttons{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
.date-btn{padding:16px 12px;background:#f0f0f0;border:none;border-radius:12px;cursor:pointer;font-size:14px;text-align:center;transition:all 0.2s;color:#666;display:flex;flex-direction:column;align-items:center;justify-content:center}
.date-btn:hover{background:#e0e0e0}
.date-btn.active{background:#e60012;color:#fff}
.date-btn .day{font-weight:bold;font-size:16px;margin-bottom:4px}
.date-btn .date{font-size:12px;color:#888}
.date-btn.active .date{color:#fff}
body.dark .date-btn{background:#2d3548;color:#9ca3af}
body.dark .date-btn .date{color:#ccc}
body.dark .date-btn:hover{background:#3d4558}
body.dark .date-btn.active{background:#f87171;color:#fff}
.show-card{background:#fff;border-radius:12px;padding:20px;margin-bottom:16px;cursor:pointer;border:1px solid #e5e7eb}
.show-card:hover{background:#f9fafb;border-color:#d1d5db}
body.dark .show-card{background:#1b1f3a;border-color:#2d3548}
body.dark .show-card:hover{background:#1f2437;border-color:#3d4558}
.show-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:12px;flex-wrap:wrap;gap:12px}
.show-title{font-size:18px;font-weight:bold;color:#e60012;flex:1}
body.dark .show-title{color:#f87171}
.show-time{font-size:14px;font-weight:bold;color:#666;padding:6px 12px;background:#f0f0f0;border-radius:12px;white-space:nowrap}
body.dark .show-time{background:#0a0e1a;color:#9ca3af}
.show-date{font-size:12px;color:#9ca3af;margin-bottom:8px}
.show-members{font-size:13px;color:#666;line-height:1.6}
body.dark .show-members{color:#9ca3af}
.setlist-badge{display:inline-block;padding:4px 10px;border-radius:12px;font-size:11px;font-weight:bold;margin-left:8px;color:#fff}
.loading{text-align:center;padding:60px 20px;color:#9ca3af}
.spinner{display:inline-block;width:40px;height:40px;border:4px solid rgba(0,0,0,0.1);border-top-color:#e60012;border-radius:50%;animation:spin 0.8s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}
body.dark .spinner{border-color:rgba(255,255,255,0.1);border-top-color:#f87171}
.no-shows{text-align:center;padding:60px 20px;color:#9ca3af;font-size:14px}
@media (max-width:767px){
header{padding:15px 50px 15px 50px;font-size:20px}
.back-btn,.theme-toggle{width:35px;height:35px;left:10px}
.theme-toggle{right:10px;left:auto}
.container{padding:15px}
.show-header{flex-direction:column;align-items:flex-start}
.show-time{width:100%}
.date-buttons{gap:8px}
.date-btn{padding:14px 10px}
.date-btn .day{font-size:14px}
.date-btn .date{font-size:11px}
}
</style>
</head>
<body>
<header>
<button class="back-btn" onclick="goBack()" title="Kembali">
<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
</button>
JADWAL SHOW
<button class="theme-toggle" onclick="toggleTheme()" title="Toggle Dark Mode">
<svg id="themeIcon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M21.64,13a1,1,0,0,0-1.05-.14,8.05,8.05,0,0,1-3.37.73A8.15,8.15,0,0,1,9.08,5.49a8.59,8.59,0,0,1,.25-2A1,1,0,0,0,8,2.36,10.14,10.14,0,1,0,22,14.05,1,1,0,0,0,21.64,13Zm-9.5,6.69A8.14,8.14,0,0,1,7.08,5.22v.27A10.15,10.15,0,0,0,17.22,15.63a9.79,9.79,0,0,0,2.1-.22A8.11,8.11,0,0,1,12.14,19.73Z"/></svg>
</button>
</header>

<div class="container">
<div class="date-filter">
<h3>Pilih Tanggal</h3>
<div class="date-buttons" id="dateButtons"></div>
</div>
<div id="showList">
<div class="loading">
<div class="spinner"></div>
<div style="margin-top:16px">Memuat jadwal...</div>
</div>
</div>
</div>

<script>
const SUPABASE_URL="https://pprxfopqkvpeajeoxzig.supabase.co";
const SUPABASE_KEY="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBwcnhmb3Bxa3ZwZWFqZW94emlnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYyNTI4MTIsImV4cCI6MjA4MTgyODgxMn0.iXRO_dAHhtVHRLqGTresG_63RD2zIaopNXtXYNfthdg";
const db=supabase.createClient(SUPABASE_URL,SUPABASE_KEY);

let currentDate=new Date().toISOString().split('T')[0];
let allShows=[];

function initializeTheme(){
const savedTheme=localStorage.getItem('jkt48_theme')||'light';
if(savedTheme==='dark'){
document.body.classList.add('dark');
document.getElementById('themeIcon').innerHTML='<path d="M12,17a5,5,0,1,1,5-5A5,5,0,0,1,12,17Zm0-8a3,3,0,1,0,3,3A3,3,0,0,0,12,9Zm0-4a1,1,0,0,0,1-1V3a1,1,0,0,0-2,0V4A1,1,0,0,0,12,5ZM5.64,7.05a1,1,0,0,0,.7.29,1,1,0,0,0,.71-.29,1,1,0,0,0,0-1.41L6.34,5A1,1,0,0,0,4.93,6.34ZM5,12a1,1,0,0,0-1-1H3a1,1,0,0,0,0,2H4A1,1,0,0,0,5,12Zm.64,5.66a1,1,0,0,0,0,1.41,1,1,0,0,0,1.41,0l.71-.71a1,1,0,0,0-1.41-1.41ZM12,19a1,1,0,0,0-1,1v1a1,1,0,0,0,2,0V20A1,1,0,0,0,12,19Zm6.36-2.34a1,1,0,0,0-1.41,1.41l.71.71a1,1,0,0,0,1.41,0,1,1,0,0,0,0-1.41ZM21,11H20a1,1,0,0,0,0,2h1a1,1,0,0,0,0-2Zm-3.64-3.95a1,1,0,0,0,.7.29,1,1,0,0,0,.71-1.7l-.71-.71a1,1,0,0,0-1.41,1.41Z"/>';
}
}

function toggleTheme(){
document.body.classList.toggle('dark');
const icon=document.getElementById('themeIcon');
if(document.body.classList.contains('dark')){
icon.innerHTML='<path d="M12,17a5,5,0,1,1,5-5A5,5,0,0,1,12,17Zm0-8a3,3,0,1,0,3,3A3,3,0,0,0,12,9Zm0-4a1,1,0,0,0,1-1V3a1,1,0,0,0-2,0V4A1,1,0,0,0,12,5ZM5.64,7.05a1,1,0,0,0,.7.29,1,1,0,0,0,.71-.29,1,1,0,0,0,0-1.41L6.34,5A1,1,0,0,0,4.93,6.34ZM5,12a1,1,0,0,0-1-1H3a1,1,0,0,0,0,2H4A1,1,0,0,0,5,12Zm.64,5.66a1,1,0,0,0,0,1.41,1,1,0,0,0,1.41,0l.71-.71a1,1,0,0,0-1.41-1.41ZM12,19a1,1,0,0,0-1,1v1a1,1,0,0,0,2,0V20A1,1,0,0,0,12,19Zm6.36-2.34a1,1,0,0,0-1.41,1.41l.71.71a1,1,0,0,0,1.41,0,1,1,0,0,0,0-1.41ZM21,11H20a1,1,0,0,0,0,2h1a1,1,0,0,0,0-2Zm-3.64-3.95a1,1,0,0,0,.7.29,1,1,0,0,0,.71-1.7l-.71-.71a1,1,0,0,0-1.41,1.41Z"/>';
localStorage.setItem('jkt48_theme','dark');
}else{
icon.innerHTML='<path d="M21.64,13a1,1,0,0,0-1.05-.14,8.05,8.05,0,0,1-3.37.73A8.15,8.15,0,0,1,9.08,5.49a8.59,8.59,0,0,1,.25-2A1,1,0,0,0,8,2.36,10.14,10.14,0,1,0,22,14.05,1,1,0,0,0,21.64,13Zm-9.5,6.69A8.14,8.14,0,0,1,7.08,5.22v.27A10.15,10.15,0,0,0,17.22,15.63a9.79,9.79,0,0,0,2.1-.22A8.11,8.11,0,0,1,12.14,19.73Z"/>';
localStorage.setItem('jkt48_theme','light');
}
}

function goBack(){
window.location.href='index.html';
}

async function loadSchedule(){
try{
const today=new Date();
const dates=[];
for(let i=0;i<7;i++){
const date=new Date(today);
date.setDate(today.getDate()+i);
dates.push(date.toISOString().split('T')[0]);
}
const{data,error}=await db.from('setlist_performance').select('*').in('show_date',dates).order('show_date',{ascending:true}).order('show_time',{ascending:true});
if(error)throw error;
allShows=data||[];
renderDateButtons(dates);
renderShows(currentDate);
}catch(err){
console.error('Error:',err);
document.getElementById('showList').innerHTML='<div class="no-shows">Gagal memuat jadwal</div>';
}
}

function renderDateButtons(dates){
const container=document.getElementById('dateButtons');
container.innerHTML='';
const dayNames=['Min','Sen','Sel','Rab','Kam','Jum','Sab'];
const monthNames=['Jan','Feb','Mar','Apr','Mei','Jun','Jul','Agu','Sep','Okt','Nov','Des'];
dates.forEach(date=>{
const btn=document.createElement('button');
btn.className='date-btn';
if(date===currentDate)btn.classList.add('active');
const d=new Date(date);
const dayIndex=d.getDay();
const dayName=dayNames[dayIndex];
const dayNumber=d.getDate();
const monthIndex=d.getMonth();
const monthName=monthNames[monthIndex];
btn.innerHTML=`
<span class="day">${dayName}</span>
<span class="date">${dayNumber} ${monthName}</span>
`;
btn.onclick=()=>{
currentDate=date;
document.querySelectorAll('.date-btn').forEach(b=>b.classList.remove('active'));
btn.classList.add('active');
renderShows(date);
};
container.appendChild(btn);
});
}

function renderShows(date){
const filtered=allShows.filter(s=>s.show_date===date);
const container=document.getElementById('showList');
if(filtered.length===0){
container.innerHTML='<div class="no-shows">Tidak ada show pada tanggal ini</div>';
return;
}
const grouped={};
filtered.forEach(show=>{
const key=`${show.setlist_name}_${show.show_time}`;
if(!grouped[key]){
grouped[key]={
setlist:show.setlist_name,
time:show.show_time,
date:show.show_date,
members:[],
isBirthday:show.is_birthday_show,
birthdayMember:show.birthday_member
};
}
grouped[key].members.push(show.name);
});
container.innerHTML='';
Object.values(grouped).forEach(show=>{
const card=document.createElement('div');
card.className='show-card';
card.onclick=()=>openShowDetail(show.setlist,show.date);
const memberCount=show.members.length;
let badgeColor='#e60012';
const setlistLower=show.setlist.toLowerCase();
if(memberCount===16){
badgeColor='#e60012';
}else{
if(setlistLower.includes('ramune')){
badgeColor='#00CED1';
}else if(setlistLower.includes('tsunaginagara')||setlistLower.includes('tte')){
badgeColor='#FF69B4';
}else if(setlistLower.includes('pertaruhan')){
badgeColor='#D30000';
}else if(setlistLower.includes('pajama')){
badgeColor='#00006d';
}
}
let title=show.setlist;
if(show.isBirthday&&show.birthdayMember)title+=` (STS ${show.birthdayMember})`;
const dayNames=['Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu'];
const monthNames=['Januari','Februari','Maret','April','Mei','Juni','Juli','Agustus','September','Oktober','November','Desember'];
const d=new Date(show.date);
const dayName=dayNames[d.getDay()];
const dayNumber=d.getDate();
const monthName=monthNames[d.getMonth()];
const year=d.getFullYear();
card.innerHTML=`
<div class="show-header">
<div class="show-title">${title}<span class="setlist-badge" style="background:${badgeColor}">${memberCount} member</span></div>
<div class="show-time">${show.time.slice(0,5)} WIB</div>
</div>
<div class="show-date">${dayName}, ${dayNumber} ${monthName} ${year}</div>
<div class="show-members">${show.members.sort().join(', ')}</div>
`;
container.appendChild(card);
});
}

function openShowDetail(setlist,date){
window.location.href=`liveshow.html?setlist=${encodeURIComponent(setlist)}&date=${date}`;
}

document.addEventListener('DOMContentLoaded',()=>{
initializeTheme();
loadSchedule();
});
</script>
</body>
</html>